# 结构及原理

## (1)位置

```
+--------++-------++--------------+
|        ||       ||              |
|        ||       ||              |
|        ||       ||              |
|        ||       ||              |
|        ||       || +--+   +--+  |
|        ||       || +--+   +--+  |
|        ||       |+--------------+
| +----+ || +---+ |
| +----+ || +---+ |
+--------++-------+

```
> * 第一个列表窗口使用g.run(1,3)--跳转到第二个窗口后仍然显示
> * 第二个列表窗口使用g.run(24,3)--跳转到第三个窗口后仍然显示
> * 第三个编辑窗口使用g.runOnce(45,3)--点击确定/取消后消失


## (2)构图

### 一层和二层

```
+-----------------+
| +-------------+ |
| |    list     | |
| +-------------+ |
| +-------------+ |
| |    back     | |
| +-------------+ |
+-----------------+
```

### 三层目录

```
+-------------------------------+
| +-------------+-------------+ |
| |  label      |   text      | |
| +-------------+-------------+ |
| |  label      |   entry     | |
| +-------------+-------------+-+---------subgrid
| |  label      |   checks    | |
| +-------------+-------------+ |
| |  label      |   radios    | |
| +-------------+-------------+ |
| +---------------------------+ |
| |                           | |
| |          button           +-+---------buttons
| |                           | |
| +---------------------------+ |
+-------------------------------+---------gridform
```
## (3)函数实现

### 一级及二级菜单

一级及二级菜单均是列表，故二级菜单可以进行复用，通过传入不同的列表值显示不同的菜单项

> * self.main_location 标记一级菜单选择的第几行，会根据此参数，传给第二级菜单列表参数,显示对应二级窗口
> * self.sec_location 标记二级菜单选择的第几行

### 三级编辑窗口

三级编辑窗口是对复选框、单选框、编辑框等进行了封装。点击确定后会继续弹出确认框。同时返回的是json串，非常容易处理

### 二级菜单跳转到三级编辑窗口

因为二级菜单窗口总共只有一个函数，传入不同的列表值会显示不同的列表，但是二级菜单列表需要对应相应的编辑窗口

此处的实现是通过config.py 中的"三级标记"实现的
```
config_secondary = [{
        'name': 'window1',
        'items':  [("二级目录1_1","1_1"),
                   ("二级目录1_2","1_2"),
                   ("二级目录1_3","1_3"),
        ],
    },
]
```
config_secondary 是所有二级菜单的列表集合

其中列表中的字典为一个二级菜单

其中，items的元素的第0值是二级菜单显示项目、第一个值即为"三级标记"

```
for fun in inspect.getmembers(self, predicate=inspect.ismethod):
    if fun[0][:5] == "three" and (secondary_window["items"][self.sec_location-1][1] in fun[0]):
         return fun[1]()
```
在二级菜单项点击回车后，程序会遍历类中的所有函数，会跳转到以three开头并包含三级标记的函数。

